<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>黃之鋒玩遊戲產生器 </title>
    <script src="js/load-image.all.min.js"></script>
</head>
<body>
    <div class="webuploader-container">
        <h3>黃之鋒玩遊戲 產生器</h3>
        <br>
        作者:一個PTT小鄉民
        <div>
            <div class="webuploader-pick">上傳任何一張遊戲圖片</div>
            <br>
            <input type="file" accept="image/*" id="file-input"/>
        </div>
    </div>
    <canvas id="canvas" width="800" height="598"></canvas>
    <br>
    <div id="poorHolder" style="display:none">
        又多了一款中國人不能玩的遊戲
        QQ
        <img src="poor04.gif" alt="可憐哪" width="100" height="100"> 
    </div>
</body>

<script> 



document.getElementById('file-input').onchange = function (e) {
    var loadingImage = loadImage(
        e.target.files[0],
        function (img) {
            var canvas = document.getElementById("canvas");
            var ctx = canvas.getContext("2d");

            var img1 = loadImage('background.png', main);
            var img2 = loadImage(img.toDataURL(), main);

            var imagesLoaded = 0;
            function main() {
                imagesLoaded += 1;

                if(imagesLoaded == 2) {
                    // composite now
                    ctx.drawImage(img1, 0, 0);

                    ctx.globalAlpha = 1;
                    ctx.translate(15,310)
                    ctx.rotate(Math.PI * -1.3 / 180);
                    ctx.drawImage(img2, 0, 0 ,img2.width,img2.height,0,0,470,260);
                }
            }

            function loadImage(src, onload) {
                // http://www.thefutureoftheweb.com/blog/image-onload-isnt-being-called
                var img = new Image();

                img.onload = onload;
                img.src = src;

                return img;
            }
        },
        {orientation: 1}
    );
    document.getElementById("poorHolder").style.display = "block";
    

};

</script>
    <style>

* { 
    margin:0; padding:0; 
} /* to remove the top and left whitespace */

html, body { 
    width:100%; height:100%; 
} /* just to be sure these are full screen*/

canvas { 
    display:block; 
} /* To remove the scrollbars */
    </style>
</html>